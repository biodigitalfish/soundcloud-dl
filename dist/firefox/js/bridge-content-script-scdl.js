const s="soundcloud-dl-bridge";window.addEventListener("message",e=>{if(e.source!==window||!e.data||e.data.source!==s||e.data.direction!=="to-background-via-bridge")return;const r=e.data.payload,o=e.data.messageId;r&&r.type&&o?chrome.runtime.sendMessage(r,a=>{chrome.runtime.lastError?(console.error("[Bridge] Error sending message to background or receiving response:",chrome.runtime.lastError),window.postMessage({source:s,direction:"from-background-via-bridge",payload:{error:chrome.runtime.lastError.message,originalMessage:r},messageId:o},"*")):window.postMessage({source:s,direction:"from-background-via-bridge",payload:a,messageId:o},"*")}):console.warn("[Bridge] Received message from page is invalid or missing messageId:",e.data)}),chrome.runtime.onMessage.addListener((e,r,o)=>(r.id===chrome.runtime.id&&!r.tab&&window.postMessage({source:s,direction:"from-background-via-bridge",payload:e},"*"),!1)),console.debug("[SoundCloud DL] Bridge content script loaded and listening.");
